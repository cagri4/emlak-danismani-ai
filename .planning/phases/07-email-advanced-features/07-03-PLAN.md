---
phase: 07-email-advanced-features
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - src/pages/Customers.tsx
autonomous: true
requirements:
  - MUST-06

must_haves:
  truths:
    - "User can filter customers by hot/warm/cold temperature"
    - "Filtered list shows only customers matching selected temperature"
    - "Filter persists while user interacts with the page"
  artifacts:
    - path: "src/pages/Customers.tsx"
      provides: "Customer filtering by lead temperature"
      contains: "filterTemperature"
  key_links:
    - from: "src/pages/Customers.tsx"
      to: "useLeadScores"
      via: "temperature filter logic"
      pattern: "scoreData\\.temperature.*filterTemperature"
---

<objective>
Verify and enhance customer filtering by lead temperature (hot/warm/cold) for prioritized lead management.

Purpose: Confirm MUST-06 requirement is satisfied - users can filter customers by lead temperature
Output: Verified customer filtering functionality with count badges and empty state handling
</objective>

<execution_context>
@/home/cagr/.claude/get-shit-done/workflows/execute-plan.md
@/home/cagr/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Existing implementation
@src/pages/Customers.tsx
@src/hooks/useLeadScore.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add count badges and empty state to customer filtering</name>
  <files>
    src/pages/Customers.tsx
  </files>
  <action>
The customer temperature filtering is already implemented. Enhance it with count badges:

1. **Add temperatureCounts calculation** after leadScores useMemo:
   ```typescript
   const temperatureCounts = useMemo(() => {
     const counts = { hot: 0, warm: 0, cold: 0 };
     customers.forEach(c => {
       const temp = leadScores.get(c.id)?.temperature;
       if (temp) counts[temp]++;
     });
     return counts;
   }, [customers, leadScores]);
   ```

2. **Update filter button text** to include counts:
   - Change "Sicak" to show: `Sicak (${temperatureCounts.hot})`
   - Change "Ilik" to show: `Ilik (${temperatureCounts.warm})`
   - Change "Soguk" to show: `Soguk (${temperatureCounts.cold})`

3. **Add empty state for filtered results**:
   After the filter controls, before the customer grid, add:
   ```tsx
   {filteredAndSortedCustomers.length === 0 && customers.length > 0 && (
     <div className="text-center py-8 text-muted-foreground">
       Secilen filtreye uygun musteri bulunamadi
     </div>
   )}
   ```

4. **Verify existing implementation works**:
   - filterTemperature state exists (line 14)
   - Filter logic in useMemo (lines 24-28)
   - Filter buttons with onClick handlers (lines 125-169)
  </action>
  <verify>
    - npm run build (no errors)
    - Check Customers.tsx has temperatureCounts useMemo
    - Check filter buttons show counts in parentheses
    - Check empty state message exists
  </verify>
  <done>
    - Count badges added to filter buttons (Sicak (N), Ilik (N), Soguk (N))
    - Empty state message shows when filter returns no results
    - Customer filtering by temperature works correctly
  </done>
</task>

<task type="auto">
  <name>Task 2: Verify filtering works end-to-end</name>
  <files>
    src/pages/Customers.tsx
  </files>
  <action>
Run the application and verify the filtering functionality:

1. **Run dev server**: npm run dev
2. **Navigate to /customers**
3. **Document verification results** in SUMMARY.md:
   - Filter buttons visible with counts
   - Clicking each filter shows correct customers
   - Empty state appears when no customers match
   - Visual selection feedback works

If any issues found, fix them in Customers.tsx.
  </action>
  <verify>
    - npm run dev works without errors
    - Customers page loads
    - All filter buttons functional
  </verify>
  <done>
    - Filtering verified working end-to-end
    - User can filter customers by temperature (MUST-06 satisfied)
  </done>
</task>

</tasks>

<verification>
1. Run `npm run build` - should complete without errors
2. Filter state and logic exist in Customers.tsx
3. Filter buttons show customer counts
4. Empty state appears when no customers match filter
5. Visual selection feedback on active filter
</verification>

<success_criteria>
- Users can filter customers by clicking Sicak/Ilik/Soguk buttons
- Filter buttons show count of customers in each category
- Filtered list correctly shows only matching temperature customers
- Empty state message when no customers match filter
- Filter selection is visually indicated
</success_criteria>

<output>
After completion, create `.planning/phases/07-email-advanced-features/07-03-SUMMARY.md`
</output>
