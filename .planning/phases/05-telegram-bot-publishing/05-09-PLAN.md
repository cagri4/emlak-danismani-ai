---
phase: 05-telegram-bot-publishing
plan: 09
type: execute
wave: 1
depends_on: []
files_modified:
  - src/pages/PropertyDetail.tsx
autonomous: true
gap_closure: true
requirements: [ESLE-07]

must_haves:
  truths:
    - "User can view AI-generated price suggestion from property detail page"
    - "User can request detailed valuation report from property detail page"
    - "ValuationCard displays correctly below property information"
  artifacts:
    - path: "src/pages/PropertyDetail.tsx"
      provides: "Property detail page with integrated ValuationCard"
      contains: "ValuationCard"
  key_links:
    - from: "src/pages/PropertyDetail.tsx"
      to: "src/components/property/ValuationCard.tsx"
      via: "component import and render"
      pattern: "import.*ValuationCard"
---

<objective>
Integrate the existing ValuationCard component into the PropertyDetail page so users can access AI-generated price suggestions and valuation reports.

Purpose: Close Gap 3 from verification - ValuationCard component exists but is not rendered in PropertyDetail.tsx
Output: PropertyDetail page displays ValuationCard component with propertyId prop
</objective>

<execution_context>
@/home/cagr/.claude/get-shit-done/workflows/execute-plan.md
@/home/cagr/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-telegram-bot-publishing/05-06-SUMMARY.md
@src/pages/PropertyDetail.tsx
@src/components/property/ValuationCard.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Import and render ValuationCard in PropertyDetail</name>
  <files>src/pages/PropertyDetail.tsx</files>
  <action>
1. Add import statement at top of file:
   ```typescript
   import { ValuationCard } from '@/components/property/ValuationCard'
   ```

2. Find the appropriate location in the JSX to render ValuationCard
   - Place it after the "Ilan Bilgileri" (Listing Info) card section
   - Render inside a Card component for visual consistency with other sections
   - Example placement:

   ```tsx
   {/* AI Valuation Section */}
   <Card>
     <CardHeader>
       <CardTitle>AI Degerleme</CardTitle>
     </CardHeader>
     <CardContent>
       <ValuationCard propertyId={id!} />
     </CardContent>
   </Card>
   ```

3. Ensure the ValuationCard is only rendered when property exists and id is available:
   - The component is inside the main return statement which already checks `!property`
   - Use id! (non-null assertion) since we know id exists at this point

4. Position the ValuationCard section logically:
   - After: AI Description Section (existing)
   - Before: Photos Section
   - Rationale: Keeps AI features grouped together

Gap reason: ValuationCard component exists but is not imported or rendered in PropertyDetail.tsx
Reference: src/components/property/ValuationCard.tsx exports ValuationCard({ propertyId })
  </action>
  <verify>
1. Run `cd /home/cagr/Masaüstü/emlak-danismani-ai-asistanı && npm run build`
2. Grep for "ValuationCard" import in PropertyDetail.tsx
3. Grep for "<ValuationCard" render in PropertyDetail.tsx
4. Verify propertyId prop is passed correctly
  </verify>
  <done>
PropertyDetail.tsx imports ValuationCard, renders it with propertyId prop, TypeScript compiles without errors
  </done>
</task>

<task type="auto">
  <name>Task 2: Style ValuationCard wrapper for consistency</name>
  <files>src/pages/PropertyDetail.tsx</files>
  <action>
1. Review ValuationCard's internal styling (it has its own bg-white rounded-lg shadow-md p-6)
2. Since ValuationCard has its own styling, we have two options:
   - Option A: Wrap in a plain div (ValuationCard has its own Card styling)
   - Option B: Remove ValuationCard's internal Card styling and use external Card

   **Choose Option A** (less invasive, preserves ValuationCard standalone usability):
   ```tsx
   {/* AI Valuation Section */}
   {id && (
     <div className="space-y-6">
       <ValuationCard propertyId={id} />
     </div>
   )}
   ```

3. Ensure consistent spacing with other sections (space-y-6 is used throughout PropertyDetail)

4. Add optional section heading if ValuationCard doesn't have one prominent enough:
   - ValuationCard already has h3 "AI Degerleme" inside, so no additional heading needed

Note: ValuationCard is self-contained with its own styling. We just need to place it in the layout flow.
  </action>
  <verify>
1. Run `cd /home/cagr/Masaüstü/emlak-danismani-ai-asistanı && npm run build`
2. No TypeScript errors related to ValuationCard
3. Visual spacing should match other sections
  </verify>
  <done>
ValuationCard integrated with consistent spacing, build succeeds
  </done>
</task>

</tasks>

<verification>
1. `cd /home/cagr/Masaüstü/emlak-danismani-ai-asistanı && npm run build` - TypeScript compilation succeeds
2. `grep "ValuationCard" src/pages/PropertyDetail.tsx` shows import and usage
3. ValuationCard appears in PropertyDetail page when viewing a property
</verification>

<success_criteria>
- ValuationCard is imported in PropertyDetail.tsx
- ValuationCard is rendered with correct propertyId prop
- TypeScript compiles without errors
- Users can see AI valuation section on property detail page
- Gap 3 from VERIFICATION.md is closed: ESLE-07 requirement satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/05-telegram-bot-publishing/05-09-SUMMARY.md`
</output>
