---
phase: 01-foundation-compliance
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - vite.config.ts
  - tsconfig.json
  - tailwind.config.js
  - postcss.config.js
  - src/lib/firebase.ts
  - src/contexts/AuthContext.tsx
  - src/hooks/useAuth.ts
  - src/pages/Login.tsx
  - src/pages/Register.tsx
  - src/pages/ForgotPassword.tsx
  - src/pages/VerifyEmail.tsx
  - src/components/auth/ProtectedRoute.tsx
  - src/components/ui/*.tsx
  - src/lib/utils.ts
  - src/App.tsx
  - src/main.tsx
  - index.html
  - .env.example
  - firestore.rules
autonomous: true
requirements:
  - ALTI-01
  - ALTI-02
  - ALTI-03
user_setup:
  - service: firebase
    why: "Authentication and database backend"
    env_vars:
      - name: VITE_FIREBASE_API_KEY
        source: "Firebase Console -> Project Settings -> General -> Web App"
      - name: VITE_FIREBASE_AUTH_DOMAIN
        source: "Firebase Console -> Project Settings -> General"
      - name: VITE_FIREBASE_PROJECT_ID
        source: "Firebase Console -> Project Settings -> General"
      - name: VITE_FIREBASE_STORAGE_BUCKET
        source: "Firebase Console -> Project Settings -> General"
      - name: VITE_FIREBASE_MESSAGING_SENDER_ID
        source: "Firebase Console -> Project Settings -> General"
      - name: VITE_FIREBASE_APP_ID
        source: "Firebase Console -> Project Settings -> General"
    dashboard_config:
      - task: "Create Firebase project with Firestore in europe-west1 region"
        location: "Firebase Console -> Create Project -> Database Location: eur3 (europe-west1)"
      - task: "Enable Email/Password authentication"
        location: "Firebase Console -> Authentication -> Sign-in method -> Email/Password"
      - task: "Enable Google authentication"
        location: "Firebase Console -> Authentication -> Sign-in method -> Google"

must_haves:
  truths:
    - "User can register with email, password, name, phone, and company"
    - "User can log in with email/password and session persists"
    - "User can log in with Google OAuth"
    - "User can request password reset and receive email"
    - "Unverified users see verification reminder"
  artifacts:
    - path: "src/lib/firebase.ts"
      provides: "Firebase app, auth, and db instances"
      exports: ["app", "auth", "db"]
    - path: "src/contexts/AuthContext.tsx"
      provides: "Auth state management"
      exports: ["AuthProvider", "useAuth"]
    - path: "src/pages/Login.tsx"
      provides: "Login form with email/password and Google"
      min_lines: 50
    - path: "src/pages/Register.tsx"
      provides: "Registration form with all required fields"
      min_lines: 80
  key_links:
    - from: "src/contexts/AuthContext.tsx"
      to: "firebase/auth"
      via: "onAuthStateChanged subscription"
      pattern: "onAuthStateChanged"
    - from: "src/pages/Register.tsx"
      to: "firebase/auth"
      via: "createUserWithEmailAndPassword + sendEmailVerification"
      pattern: "createUserWithEmailAndPassword.*sendEmailVerification"
    - from: "src/App.tsx"
      to: "AuthContext"
      via: "AuthProvider wrapper"
      pattern: "AuthProvider"
---

<objective>
Set up React + Vite + TypeScript project with Firebase authentication system supporting email/password and Google OAuth.

Purpose: Establish the foundational project structure and authentication that all other features depend on. Users must be able to register, log in, and reset passwords before accessing property management.

Output: Working Vite project with Firebase auth, login/register pages, protected routes, and email verification flow.
</objective>

<execution_context>
@/home/cagr/.claude/get-shit-done/workflows/execute-plan.md
@/home/cagr/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-foundation-compliance/01-RESEARCH.md
@.planning/phases/01-foundation-compliance/01-CONTEXT.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize Vite + React + TypeScript Project with Dependencies</name>
  <files>
    package.json
    vite.config.ts
    tsconfig.json
    tailwind.config.js
    postcss.config.js
    src/lib/utils.ts
    src/main.tsx
    src/App.tsx
    index.html
    .env.example
    .gitignore
    src/index.css
  </files>
  <action>
Create a new Vite + React + TypeScript project using `npm create vite@latest . -- --template react-ts`.

Install dependencies:
- Core: `firebase react-router-dom`
- UI/Styling: `tailwindcss postcss autoprefixer lucide-react date-fns clsx tailwind-merge`
- Forms: `react-hook-form zod @hookform/resolvers`

Initialize Tailwind CSS with `npx tailwindcss init -p`.

Initialize shadcn/ui with `npx shadcn-ui@latest init` (use defaults, New York style, zinc color). Add required components: `npx shadcn-ui@latest add button card input form label toast`.

Configure tailwind.config.js with Turkish font support and proper content paths.

Create src/lib/utils.ts with cn() utility function (clsx + tailwind-merge).

Create .env.example with all required Firebase environment variables (VITE_FIREBASE_*).

Update .gitignore to exclude .env files.

Configure vite.config.ts with path aliases (@/ -> src/).

Update index.html with Turkish lang attribute and proper meta tags.
  </action>
  <verify>
Run `npm run dev` - Vite dev server starts without errors.
Run `npm run build` - Production build succeeds.
Verify src/components/ui/button.tsx exists (shadcn/ui installed correctly).
  </verify>
  <done>
Vite dev server runs at localhost:5173, TypeScript compiles without errors, Tailwind styles apply, shadcn/ui components available.
  </done>
</task>

<task type="auto">
  <name>Task 2: Configure Firebase and Create Auth Context</name>
  <files>
    src/lib/firebase.ts
    src/contexts/AuthContext.tsx
    src/hooks/useAuth.ts
    src/types/user.ts
    firestore.rules
  </files>
  <action>
Create src/lib/firebase.ts:
- Import Firebase modular SDK v10+ (initializeApp, getAuth, getFirestore)
- Configure with environment variables (import.meta.env.VITE_FIREBASE_*)
- Export app, auth, db instances
- Add development emulator connection (check import.meta.env.DEV)

Create src/types/user.ts:
- Define UserProfile type: { uid, email, name, phone, company, emailVerified, createdAt, kvkkConsent: null | { acceptedAt, version } }
- Define AuthUser type extending Firebase User

Create src/contexts/AuthContext.tsx:
- Create AuthContext with user state (Firebase User | null) and loading state
- Implement AuthProvider with onAuthStateChanged subscription
- Export useAuth hook for consuming auth state
- Include userProfile state (fetched from Firestore /users/{uid})

Create src/hooks/useAuth.ts:
- signInWithEmail(email, password) - uses signInWithEmailAndPassword
- signInWithGoogle() - uses GoogleAuthProvider + signInWithPopup
- signUpWithEmail(data: RegisterFormData) - creates user, updates profile, sends verification email, creates Firestore user doc
- sendPasswordReset(email) - uses sendPasswordResetEmail
- signOut() - uses Firebase signOut
- Turkish error message mapping for all Firebase auth error codes

Create firestore.rules:
- User can only read/write their own data under /users/{userId}
- Properties under /users/{userId}/properties/ - same ownership rule
- Require auth.uid == userId for all operations
  </action>
  <verify>
TypeScript compiles without errors.
Review firestore.rules - verify ownership checks are present.
Console logs show AuthProvider initialization when app loads.
  </verify>
  <done>
Firebase initialized with auth and db instances. AuthContext provides user state to entire app. Auth hooks ready for use in components. Security rules enforce user-scoped data access.
  </done>
</task>

<task type="auto">
  <name>Task 3: Create Auth Pages and Protected Routes</name>
  <files>
    src/pages/Login.tsx
    src/pages/Register.tsx
    src/pages/ForgotPassword.tsx
    src/pages/VerifyEmail.tsx
    src/components/auth/ProtectedRoute.tsx
    src/components/auth/AuthLayout.tsx
    src/lib/validations.ts
    src/App.tsx
  </files>
  <action>
Create src/lib/validations.ts:
- Define loginSchema with Zod: email (valid email), password (min 6 chars)
- Define registerSchema: email, password (min 6), name (required), phone (Turkish format optional), company (optional)
- Export inferred types: LoginFormData, RegisterFormData

Create src/components/auth/AuthLayout.tsx:
- Centered card layout for auth pages
- Logo/brand at top
- Consistent styling across login/register/forgot pages

Create src/pages/Login.tsx:
- Form with email and password fields using React Hook Form + Zod
- "Google ile Giriş Yap" button with Google icon
- Link to register page ("Hesabınız yok mu? Kayıt olun")
- Link to forgot password page
- Show toast on error with Turkish error messages
- Redirect to /dashboard on success (or to /kvkk if consent needed - handled in ProtectedRoute)

Create src/pages/Register.tsx (per user decision: email, password, name, phone, company):
- Form fields: Email, Şifre, Ad Soyad, Telefon, Şirket Adı
- Submit creates account, sends verification email, creates Firestore user profile
- Show "Doğrulama e-postası gönderildi" message on success
- Redirect to /verify-email page
- Include terms checkbox: "Kullanım koşullarını kabul ediyorum"

Create src/pages/ForgotPassword.tsx:
- Email input only
- "Şifre Sıfırlama Bağlantısı Gönder" button
- Success message: "Şifre sıfırlama bağlantısı e-posta adresinize gönderildi"
- Link back to login

Create src/pages/VerifyEmail.tsx:
- Informational page shown after registration
- "E-posta adresinizi doğrulayın" heading
- "Doğrulama e-postası tekrar gönder" button
- Check user.emailVerified and redirect to /dashboard if verified
- Auto-check verification status every 3 seconds

Create src/components/auth/ProtectedRoute.tsx:
- Wrap protected routes
- If loading, show loading skeleton
- If not authenticated, redirect to /login
- If authenticated but email not verified, redirect to /verify-email
- If authenticated but no KVKK consent, redirect to /kvkk (for Plan 02)
- Render children if all checks pass

Update src/App.tsx:
- Wrap with AuthProvider
- Configure React Router with routes:
  - /login, /register, /forgot-password, /verify-email (public)
  - /dashboard, /properties, /properties/:id (protected)
  - / redirects to /dashboard
- Use ProtectedRoute for protected routes
  </action>
  <verify>
Run `npm run dev` and test:
1. Visit /login - see login form
2. Visit /register - see all required fields (email, password, name, phone, company)
3. Submit invalid form - see Turkish validation errors
4. Visit /dashboard without auth - redirected to /login
5. TypeScript compiles without errors
  </verify>
  <done>
Login page with email/password + Google OAuth. Register page with all user-specified fields. Password reset flow. Email verification page with resend button. Protected routes redirect unauthenticated users to login.
  </done>
</task>

</tasks>

<verification>
1. `npm run dev` starts without errors
2. `npm run build` produces dist/ folder without errors
3. Navigate to /login - form renders with email, password, Google button
4. Navigate to /register - form has email, password, name, phone, company fields
5. Navigate to /forgot-password - form renders with email input
6. Navigate to /dashboard without auth - redirects to /login
7. TypeScript: `npx tsc --noEmit` passes
8. ESLint: `npm run lint` passes (if configured)
</verification>

<success_criteria>
- Project builds and runs with Vite
- Firebase SDK initialized (can see network requests to Firebase)
- Login form validates and shows Turkish error messages
- Register form has all required fields per user decision
- Google OAuth button present on login page
- Protected routes redirect to login when unauthenticated
- Auth state persists across page refresh (Firebase persistence)
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-compliance/01-01-SUMMARY.md`
</output>
